<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualiza√ß√£o de Produtos JSON</title>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
        }

        h1 {
            color: #333;
            text-align: center;
        }

        #tabela-produtos {
            width: 80%;
            margin: 20px auto;
            border-collapse: collapse;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            background-color: #fff;
        }

        #tabela-produtos th, #tabela-produtos td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        #tabela-produtos th {
            background-color: #007bff;
            color: white;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #tabela-produtos tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        #tabela-produtos tr:hover {
            background-color: #e9e9e9;
        }

        .valor-monetario {
            text-align: right; /* Alinha o pre√ßo √† direita */
            font-weight: bold;
        }

    </style>
</head>
<body>

    <h1>üìã Estoque de Produtos (Dados da API)</h1>

    <table id="tabela-produtos">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Estoque</th>
                <th>Pre√ßo Unit√°rio (R$)</th>
            </tr>
        </thead>
        <tbody id="corpo-tabela">
        </tbody>
    </table>

    <script>
        // 1. Define a URL da API
        const URL_API = 'http://localhost:3001/produto/';

        // Fun√ß√£o para preencher a tabela, que agora recebe os dados por par√¢metro
        function renderizarProdutos(dadosProdutos) {
            const corpoTabela = document.getElementById('corpo-tabela');
            
            // Limpa o corpo da tabela antes de inserir novos dados (opcional, mas boa pr√°tica)
            corpoTabela.innerHTML = ''; 

            dadosProdutos.forEach(produto => {
                const linha = document.createElement('tr');
                
                // ... (Cria√ß√£o das c√©lulas como antes) ...

                // C√©lula 1: ID
                const celulaId = document.createElement('td');
                celulaId.textContent = produto.id_produto;
                linha.appendChild(celulaId);

                // C√©lula 2: Nome
                const celulaNome = document.createElement('td');
                celulaNome.textContent = produto.nome_produto;
                linha.appendChild(celulaNome);

                // C√©lula 3: Estoque
                const celulaEstoque = document.createElement('td');
                celulaEstoque.textContent = produto.quantidade_estoque_produto;
                linha.appendChild(celulaEstoque);

                // C√©lula 4: Pre√ßo Unit√°rio (usando formata√ß√£o monet√°ria)
                const celulaPreco = document.createElement('td');
                
                const precoFormatado = produto.preco_unitario_produto.toLocaleString('pt-BR', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });

                celulaPreco.textContent = precoFormatado;
                celulaPreco.classList.add('valor-monetario');
                linha.appendChild(celulaPreco);

                corpoTabela.appendChild(linha);
            });
        }

        // Nova fun√ß√£o ass√≠ncrona para buscar os dados da API
        async function buscarErenderizarProdutos() {
            try {
                // 1. Faz a requisi√ß√£o GET para a URL
                const resposta = await fetch(URL_API);

                // 2. Verifica se a resposta foi bem-sucedida (status 200-299)
                if (!resposta.ok) {
                    throw new Error(`Erro HTTP! Status: ${resposta.status}`);
                }

                // 3. Converte o corpo da resposta para JSON
                const dados = await resposta.json();

                // 4. Renderiza os dados na tabela
                renderizarProdutos(dados);

            } catch (erro) {
                // Exibe um erro no console e na tela, se a busca falhar
                console.error("Houve um erro ao buscar os dados:", erro);
                const corpoTabela = document.getElementById('corpo-tabela');
                corpoTabela.innerHTML = `<tr><td colspan="4" style="text-align: center; color: red;">N√£o foi poss√≠vel carregar os dados. Verifique se o servidor est√° rodando em ${URL_API}</td></tr>`;
            }
        }

        // Chama a fun√ß√£o para iniciar o processo de busca e renderiza√ß√£o
        window.onload = buscarErenderizarProdutos;
    </script>

</body>
</html>